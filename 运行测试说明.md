# 🚀 如何运行 Python 测试脚本

## 📋 前置要求

1. **安装 Python 3.6+**
   - 检查是否已安装：`python3 --version` 或 `python --version`

2. **安装 requests 库**
   ```bash
   pip install requests
   ```
   或
   ```bash
   pip3 install requests
   ```

## 🏃 运行测试

### 方法 1：直接运行

```bash
python3 test_google_script.py
```

或

```bash
python test_google_script.py
```

### 方法 2：使用 requirements.txt

```bash
# 安装依赖
pip install -r requirements.txt

# 运行测试
python3 test_google_script.py
```

### 方法 3：使脚本可执行（Linux/Mac）

```bash
chmod +x test_google_script.py
./test_google_script.py
```

## 📊 测试内容

脚本会测试：

1. **OPTIONS 请求**（CORS 预检）
   - 测试 `doOptions` 函数是否工作
   - 检查 CORS 配置是否正确

2. **GET 请求**
   - 测试 `doGet` 函数是否工作
   - 检查是否能获取数据

3. **POST 请求**（只有在 OPTIONS 成功时才测试）
   - 测试 `doPost` 函数是否工作
   - 检查是否能添加数据

## 📈 预期输出

### ✅ 成功的情况

```
============================================================
  Google Apps Script Web App 测试
============================================================

测试时间: 2025-12-04 00:10:00
测试 URL: https://script.google.com/macros/s/.../exec

============================================================
  测试 1: OPTIONS 请求（CORS 预检）
============================================================

✅ OPTIONS 请求成功！
   状态码: 200
   状态文本: OK
   ...

============================================================
  测试 2: GET 请求
============================================================

✅ GET 请求成功！
   状态码: 200
   响应数据: [...]
   记录数: 1

============================================================
  测试 3: POST 请求
============================================================

✅ POST 请求成功！
   状态码: 200
   ...

============================================================
  测试总结
============================================================

OPTIONS 请求: ✅ 通过
GET 请求:     ✅ 通过
POST 请求:    ✅ 通过

🎉 所有测试通过！CORS 配置正确，应用应该可以正常工作。
```

### ❌ 失败的情况

如果 OPTIONS 失败，会显示详细的错误信息和修复建议。

## 🔍 故障排除

### 问题 1：找不到 requests 库

**错误：** `ModuleNotFoundError: No module named 'requests'`

**解决：**
```bash
pip install requests
```

### 问题 2：Python 版本太旧

**错误：** 语法错误或功能不支持

**解决：** 使用 Python 3.6 或更高版本

### 问题 3：网络连接问题

**错误：** `ConnectionError` 或 `Timeout`

**解决：**
- 检查网络连接
- 检查防火墙设置
- 尝试使用 VPN（如果在受限网络环境中）

## 💡 提示

1. **测试前确保：**
   - Google Apps Script 代码已更新
   - Web App 已重新部署
   - "具有访问权限的用户" = "所有人"

2. **如果测试失败：**
   - 查看详细的错误信息
   - 检查 Google Apps Script 的执行日志
   - 确认 Web App URL 是否正确

3. **测试脚本会：**
   - 自动测试所有请求
   - 显示详细的结果
   - 提供修复建议

## 🆘 需要帮助？

如果测试脚本运行失败，请提供：
1. **完整的错误输出**
2. **Python 版本**：`python3 --version`
3. **操作系统**：Windows/Mac/Linux

这样我可以进一步帮助诊断问题。

